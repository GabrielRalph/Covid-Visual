<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <link rel = "stylesheet" href = "https://arcms.w4v.es/Assets/Supreme/stylesheet.css"/>
  </head>
  <body>
    <!-- <div id = loader>
      <h1 id = loader-text>
        Loading
      </h1>
    </div> -->
    <svg id = "timeline" ></svg>
    <svg id = "map" viewBox = "-30 -30 60 60"></svg>
  </body>

  <!-- <script type = "module">

    class Area extends SvgPath{

    }
  </script> -->

  <script type="module">
    import {CovidMap, TimeLine, getJSON} from "./Map.js"
    function download(filename, text) {
      var element = document.createElement('a');
      element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
      element.setAttribute('download', filename);

      element.style.display = 'none';
      document.body.appendChild(element);

      element.click();

      document.body.removeChild(element);
    }
    let start = async () => {
      let bounds = await getJSON("bounds.json");
      let map = new CovidMap(bounds, "map");
      await map.loadCases();

      let s = map.start;
      let e = map.end;
      // console.log(s, e);

      let timeline = new TimeLine(s, e, "timeline")
      // console.log(s, e);

      let time = s.getTime();
      let play = () => {
        map.draw(time);
        timeline.date = new Date(time);
        time += 3*24*60*60*1000;
        if (time > e.getTime()){
          time = s.getTime();
          map.onclick = () => {
            map.onclick = null;
            play()
          }
        }else{
          window.requestAnimationFrame(play)
        }
      }
      play();
      // map.draw()

    }
    start();

  </script>
  <style>
  body{
    font-family: "Supreme LL TT"
  }
    svg{
      margin: 5vw;
    }
    #map{
      /* fill: #4f89ff; */
      stroke: white;
      stroke-width: 0.075;
      /* opacity: 0.4; */
    }

    path.void{
      opacity: 0;
    }

    .keys text{
      text-anchor: end;
      font-weight: bold;
      stroke: none;
    }

    /* .timeline {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;

    } */
    .boundry:hover {
      /* stroke-width: 2; */
    }
    .timeline path{
      stroke-linecap: round;
      stroke: black;
      stroke-width: 5;
    }
    .future {
      opacity: 0.5;
    }
    .labels text{
      user-select: none;
      text-anchor: middle;
    }

    #loader {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: white;
      z-index: 100;
    }
    #loader-text {
      position: fixed;
      top: 50%;
      left: 50%;
      text-align: center;
      transform: translate(-50%, -50%);
    }
  </style>
</html>
